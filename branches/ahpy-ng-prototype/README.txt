This packages needs complete cleanup, maybe even rewrite.